# SE의 데이터 수집

현재 SE의 MES프로그램을 키고 생산관리 메뉴를 들어가보면 실시간 모니터링이란 하위 메뉴가 나옵니다. 해당 메뉴에서는 SE_GATHERING 프로그램을 통해 PLC*(산업 현장에서 사용하는 기계의 컨트롤러, 설비를 제어 및 감시하는 역할)에서 전달 받은 데이터를 데이터 베이스에 저장한 후 MES 프로그램에서 관리자가 모니터링할 수 있는 인터페이스가 구현되어 있습니다.

SE에서 ERCV와 ASSY 공정이 있는데 주로 이 두 공정에서 모니터링을 사용합니다. ERCV공정에는 BOBBIN, BUSH가, ASSY공정에는 MEB설비가 있습니다.

SE_GATHERING 프로그램을 키면 공정별 메뉴가 나옵니다. 데이터를 수집할 공정을 선택한 후 들어가면 게더링을 할 수 있는 메뉴가 나오는데, 여기서 두 가지 유형의 화면으로 나뉩니다.

**첫번째, PLC를 통한 게더링**

**두번째, 파일을 이용한 게더링**

첫번째 케이스인 PLC를 통한 게더링 방식은 PLC에서 수집한 설비 데이터가 PC로 전달되면 프로그램이 소켓을 읽어서 DB에 저장시키는 방식입니다.

두번째 케이스도 PLC에서 설비의 데이터를 수집해 PC로 전달한다는 점은 같습니다. 여기서 다른 점은 PC로 전달된 데이터를 외부 프로그램을 통해 파일로 가공한 후 로컬 드라이브에 저장한다는 것입니다. 로컬 드라이브에 저장된 게더링 파일을 읽어서 DB에 저장하는 방식을 사용하는 것이 파일을 이용한 게더링 방식입니다.

# 테이블 종류

- `GATHERING~` `PLC~` 키워드로 시작하는 테이블 = **PLC에서 넘어온 미가공 데이터를 저장하는 테이블**
- `S_~` 키워드로 시작하는 테이블 = **모니터링에서 조회하는 가공된 데이터가 있는 테이블**
- `S_FILE_GATHERING_LOG` = 파일 게더링 이력 저장용 테이블

# 프로시저 종류

- `SP_GET_PLC_DATA` 모니터링에서 데이터를 가공하기 위해 사용
- `SP_GET_CSV_DATA` 모니터링에서 파일 데이터 읽을 때 사용
- `SP_GET_AUTO_PLC_SERIAL_NO` 자동으로 시리얼번호 생성해주는 프로시저
- `SP_GET_GATHERING_DATA` 게더링 이력을 MES에서 조회하기 위해 사용
- `SP_SAVE_CSV_DATA` 게더링 프로그램에서 파일 데이터를 저장하기 위해 사용
- `SP_SAVE_FILE_GATHERING_LOG` 파일 게더링 로그 저장하는 프로시저
- `SP_SELECT~` `SP_SAVE_~` 키워드가 들어간 프로시저는 MES 모니터링 화면에서 사용
